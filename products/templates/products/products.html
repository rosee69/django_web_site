{% extends "products/layout.html" %}

{% block title %}–¢–æ–≤–∞—Ä–∏ | Peachy Love{% endblock %}

{% block content %}

<section class="hero hero--mint">
    <div class="hero__text">
        <h1>–¢–æ–≤–∞—Ä–∏ –¥–ª—è —É–ª—é–±–ª–µ–Ω—Ü—ñ–≤</h1>
        <p>–ü—Ä–µ–º—ñ–∞–ª—å–Ω—ñ –∫–æ—Ä–º–∏, —ñ–≥—Ä–∞—à–∫–∏ —Ç–∞ —Ç—É—Ä–±–æ—Ç–∞ ‚Äì –≤—Å–µ –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ!</p>
    </div>
</section>

<section class="content-section">

    {% if user.is_staff %}
        <div class="top-actions">
            <a href="{% url 'products:product_create' %}" class="btn-primary">
                + –î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä
            </a>

        
    {% endif %}

    <div class="card-list card-list--products">

        {% for product in products %}
            <article class="card product-card">

                <div class="product-card__media">
                    {% if product.image %}
                        <img src="{{ product.image.url }}"
                             alt="{{ product.name }}"
                             class="product-card__image">
                    {% endif %}
                </div>

                <div class="product-card__body">

                    <h2 class="card__title">{{ product.name }}</h2>

                    <div class="product-card__meta">
                        <span class="product-price">{{ product.price }} ‚Ç¥</span>
                        <span class="product-country">{{ product.country }}</span>
                    </div>

                    <p class="card__text">
                        {{ product.description|truncatechars:120 }}
                    </p>

                    <span class="product-category-pill">
                        {{ product.category.title }}
                    </span>

                    <div class="card-actions">

                        <form action="{% url 'orders:add_to_cart' product.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="btn-primary">
                                üõí –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                            </button>
                        </form>

                        <a href="{% url 'products:product_detail' product.slug %}"
                           class="btn-secondary">
                            –î–µ—Ç–∞–ª—å–Ω—ñ—à–µ
                        </a>

                        <!-- üõ† –ê–î–ú–ò–ù (–°–ö–†–´–¢–û –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
                        {% if user.is_staff %}
                            <div class="admin-actions hidden">
                                <a href="{% url 'products:product_update' product.slug %}"
                                   class="btn-secondary">
                                    –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                                </a>

                                <a href="{% url 'products:product_delete' product.slug %}"
                                   class="btn-danger">
                                    –í–∏–¥–∞–ª–∏—Ç–∏
                                </a>
                            </div>
                        {% endif %}

                    </div>

                </div>
            </article>
        {% endfor %}

    </div>

    {% if is_paginated %}
        <nav class="pagination">
            <ul class="pagination__list">

                {% if page_obj.has_previous %}
                    <li class="pagination__item">
                        <a href="?page={{ page_obj.previous_page_number }}" class="pagination__link">
                            ‚Äπ –ù–∞–∑–∞–¥
                        </a>
                    </li>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                    {% if num == page_obj.number %}
                        <li class="pagination__item pagination__item--active">
                            <span class="pagination__link">{{ num }}</span>
                        </li>
                    {% else %}
                        <li class="pagination__item">
                            <a href="?page={{ num }}" class="pagination__link">{{ num }}</a>
                        </li>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                    <li class="pagination__item">
                        <a href="?page={{ page_obj.next_page_number }}" class="pagination__link">
                            –í–ø–µ—Ä–µ–¥ ‚Ä∫
                        </a>
                    </li>
                {% endif %}

            </ul>
        </nav>
    {% endif %}

</section>

{% endblock %}
